{% if current_user.role.value == "Khách hàng" %}
    {% include "layout/base.html" %}
{% else %}
    {% extends "event_organizer/layout_event_organizer/base.html" %}
{% endif %}

{% block title %}Thông tin cá nhân{% endblock %}
{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/styles_profile.css') }}">
<div class="container mt-5">
    <div class="card shadow-lg border-0 rounded-3">
        <div class="card-header text-center bg-primary text-white">
            <h4>Thông tin cá nhân</h4>
        </div>

        <div class="card-body">
            <!-- Avatar + Upload -->
            <div class="text-center mb-4">
                <img id="avatarPreview" src="{{ current_user.avatar }}"
                     alt="Avatar" class="rounded-circle border"
                     style="width:150px;height:150px;object-fit:cover;">
                <div class="mt-3">
                    <label for="avatar" class="btn btn-outline-primary">
                        Chọn ảnh
                        <input type="file" name="avatar" id="avatar" hidden>
                    </label>
                    <button type="button" id="saveAvatarBtn" class="btn btn-primary ms-2">
                        Lưu thay đổi
                    </button>
                </div>
            </div>

            <!-- Thông tin người dùng -->
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <table class="table table-borderless">
                        <tbody>
                            <tr>
                                <th scope="row">ID Người dùng</th>
                                <td>{{ current_user.id }}</td>
                            </tr>
                            <tr>
                                <th scope="row">Tên đăng nhập</th>
                                <td>{{ current_user.username }}</td>
                            </tr>
                            {% set person = current_user.customer or current_user.event_organizer %}
                            {% if person %}
                            <tr>
                                <th scope="row">Họ và Tên</th>
                                <td>{{ person.fullname }}</td>
                            </tr>
                            <tr>
                                <th scope="row">Email</th>
                                <td>{{ person.email }}</td>
                            </tr>
                            {% endif %}
                            <tr>
                                <th scope="row">Vai trò</th>
                                <td>{{ current_user.role.value }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>
{% endblock %}

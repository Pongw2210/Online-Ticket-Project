<!DOCTYPE html>
<html>
<head>
    <title>{{ event.name }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='auth_pages.css') }}">
    <link rel="icon" href="{{ url_for('static', filename='images/icons8-ticket-50.png') }}" type="image/png">
    <script src="{{ url_for('static', filename='scripts/ticket.js') }}" defer></script>
</head>
<body>
<header>
    <div class="logo">
        <a href="/"><img src="{{ url_for('static', filename='images/icons8-ticket-100.png') }}" alt="Ticketbox Logo"
                         class="logo-img"></a>
    </div>
    <form class="search-bar" method="get" action="/">
        <input type="text" name="q" value="{{ search }}" placeholder="Bạn tìm gì hôm nay?">
        <button type="submit">Tìm kiếm</button>
    </form>

    <div class="header-actions">
        <a href="/new-event" class="create-event">
            <span>Tạo sự kiện</span>
        </a>
                    <a href="/my-tickets" class="my-ticket">
            <img src="{{ url_for('static', filename='images/icons8-ticket-30.png') }}" alt="ticket icon"
                 class="ticket-icon">
            <span>Vé của tôi</span>
        </a>
    </div>

    <div class="auth-links">
        {% if current_user %}
        👋 Xin chào, <strong>{{ current_user.username }}</strong> |
        <a href="/logout">Đăng xuất</a>
        {% else %}
        <a href="/login">Đăng nhập</a> |
        <a href="/register">Đăng ký</a>
        {% endif %}
    </div>
</header>

<div class="nav">
    <a href="#">Nhạc sống</a>
    <a href="#">Sân khấu & Nghệ thuật</a>
    <a href="#">Thể thao</a>
    <a href="#">Khác</a>
</div>

<h2 class="section-title">🎟 Chọn vé</h2>
{% if current_user %}
<div style="background: rgba(76, 175, 80, 0.2); border: 1px solid #4CAF50; border-radius: 8px; padding: 15px; margin: 20px 0; text-align: center;">
    <div style="color: #4CAF50; font-weight: bold; margin-bottom: 5px;">✅ Đã đăng nhập</div>
    <div style="font-size: 14px;">Xin chào <strong>{{ current_user.username }}</strong>, bạn có thể tiếp tục mua vé!</div>
</div>
{% endif %}

{% if not has_tickets %}
<div class="no-tickets-container">
    <div class="no-tickets-icon">🎫</div>
    <div class="no-tickets-title">Hiện tại chưa có vé cho chương trình</div>
    <div class="no-tickets-message">
        Chương trình <strong>"{{ event.name }}"</strong> hiện chưa có vé được phát hành.<br>
        Vui lòng quay lại sau hoặc liên hệ với chúng tôi để biết thêm thông tin.
    </div>
    <div class="no-tickets-buttons">
        <a href="/" class="no-tickets-btn">
            ← Về trang chủ
        </a>
        <a href="/event/{{ event.id }}" class="no-tickets-btn secondary">
            ← Quay lại chi tiết sự kiện
        </a>
    </div>
</div>
{% else %}
<div class="ticket-booking-container">
    <div class="ticket-selection">
        {% for ticket in ticket_types %}
        <div class="ticket-card">
            <div class="ticket-left">
                <div class="ticket-name">{{ ticket.name }}</div>
                <ul class="ticket-benefits">
                    {% if ticket.name == 'Vé VIP' %}
                    <li>Khu vực checkin riêng, không phải xếp hàng</li>
                    <li>Ghế ngồi gần sân khấu, quà tặng đặc biệt</li>
                    <li>Dịch vụ ăn uống, quà tặng, giao lưu nghệ sĩ</li>
                    {% else %}
                    <li>Đảm bảo quyền lợi tham gia sự kiện</li>
                    <li>Ghế ngồi sắp xếp ngẫu nhiên</li>
                    <li>Ghế ngồi xa sân khấu</li>
                    {% endif %}
                </ul>
                <div class="ticket-price">Giá vé: {{ "{:,.0f}".format(ticket.price) }}đ</div>
                <div class="ticket-stock">Số vé còn lại: {{ ticket.stock }}</div>

                <div class="quantity-selector">
                    <button class="decrease" data-ticket-id="{{ ticket.id }}">-</button>
                    <input type="number" min="0" value="0" name="quantity_{{ ticket.id }}" class="quantity-input"
                           data-ticket-id="{{ ticket.id }}" data-price="{{ ticket.price }}"
                           data-name="{{ ticket.name }}">
                    <button class="increase" data-ticket-id="{{ ticket.id }}">+</button>
                </div>
            </div>
            <div class="ticket-right">
                <img src="{{ url_for('static', filename='images/ticketGAVIP.png') }}" class="ticket-image">
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="ticket-summary">
        <h4 style="">Tổng vé:</h4>
        <ul id="summary-list"></ul>
        <p class="total" id="summary-total"><strong>🎟 x0</strong></p>
        <a href="#" class="continue-btn" id="continue-btn" data-event-id="{{ event.id }}">Tiếp tục >></a>
    </div>
</div>
{% endif %}

<!-- Footer với bản quyền -->
<footer class="footer">
    <div class="footer-content">
        <div class="footer-section">
            <h3>TicketBox Clone</h3>
            <p>Hệ thống đặt vé sự kiện trực tuyến</p>
        </div>
        <div class="footer-section">
            <h4>Liên hệ</h4>
            <p>Email: info@ticketboxclone.com</p>
            <p>Điện thoại: 1900-xxxx</p>
        </div>
        <div class="footer-section">
            <h4>Theo dõi</h4>
            <p>Facebook | Instagram | Twitter</p>
        </div>
    </div>
    <div class="footer-bottom">
        <p>&copy; 2024 TicketBox Clone. Tất cả quyền được bảo lưu.</p>
        <p>Phát triển bởi QLDAPM Team</p>
    </div>
</footer>

</body>
</html>

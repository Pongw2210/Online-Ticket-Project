<link rel="stylesheet" href="{{ url_for('static', filename='css/styles_payment.css') }}">
{% extends 'layout/base.html' %}
{% block title %}Mua v√©{% endblock %}
{% block content %}
<section class="hero">
    <div class="hero-inner">
        <div class="event-info">
            <h1 class="event-title">{{event.name}}</h1>
            <div class="meta">
                <div>
                    {% if event.event_format.name == 'OFFLINE' %}
                    {{ event.event_offline.location }}
                    {% else %}
                    Tr·ª±c tuy·∫øn
                    {% endif %}
                </div>
                <div>üïí {{event.start_datetime}}</div>
            </div>
        </div>

        <div class="countdown" aria-hidden="true">
            <div style="
        font-size:14px;
        color:#000000;
        margin-bottom:8px;
    ">
                Ho√†n t·∫•t ƒë·∫∑t v√© trong
            </div>
            <div class="time">
                <div class="digit" id="cd-min">14</div>
                <div style="align-self:center;color:#000000;">:</div>
                <div class="digit" id="cd-sec">30</div>
            </div>
        </div>
    </div>
</section>

<main class="container">
    <div class="left">
        <h3 class="section-title">THANH TO√ÅN</h3>

        <div class="card">
            <label>Th√¥ng tin nh·∫≠n v√©</label>
            <div class="muted">V√© ƒëi·ªán t·ª≠ s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã trong m·ª•c "V√© c·ªßa t√¥i" v√† email c·ªßa t√†i kho·∫£n</div>
            <input class="input" placeholder="Email nh·∫≠n v√©" id="email"
                   value="{{current_user.fullname}} v√† {{current_user.email}} ">
        </div>

        <div class="card">
            <label>M√£ khuy·∫øn m√£i</label>
            <div class="voucher">
                <button class="btn secondary" onclick="showVoucherModal({{event.id}})">Ch·ªçn voucher</button>
            </div>
        </div>

        <div class="card">
            <label>Ph∆∞∆°ng th·ª©c thanh to√°n</label>
            <div class="payment-methods">
                <label class="method"><input type="radio" name="pay" value="vnpay" checked> <img
                        src="https://res.cloudinary.com/dgqx9xde1/image/upload/v1754895822/vnpay_d03bmz.jpg" alt=""
                        style="width:36px;height:24px;object-fit:contain">
                    VNPay / ·ª®ng d·ª•ng ng√¢n h√†ng</label>
                <label class="method"><input type="radio" name="pay" value="momo">
                    <img src="https://res.cloudinary.com/dgqx9xde1/image/upload/v1754895822/momo_opzdvv.webp" alt=""
                         style="width:36px;height:24px;object-fit:contain">
                    MoMo
                </label>

            </div>
        </div>
    </div>

    <aside class="right">
        <div class="checkout-footer">
            <!-- Th√¥ng tin ƒë·∫∑t v√© -->
            <div class="summary-card">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
                    <div style="font-weight:700">Th√¥ng tin ƒë·∫∑t v√©</div>
                    <a href="{{ url_for('events.buy_ticket', event_id=event.id) }}"
                       style="font-size:13px;color:#2b6df0;text-decoration:none">Ch·ªçn l·∫°i v√©</a>
                </div>

                <!-- Container ƒë·ªÉ JS render v√© -->
                <div id="ticket-summary"></div>
            </div>

            <!-- Th√¥ng tin ƒë∆°n h√†ng -->
            <div class="summary-card" style="padding:18px;">
                <div style="font-weight:700;margin-bottom:10px">Th√¥ng tin ƒë∆°n h√†ng</div>
                <div class="summary-row">
                    <div class="muted">T·∫°m t√≠nh</div>
                    <div id="subtotal">0 ƒë</div>
                </div>
                <div class="summary-row">
                    <div class="muted">Voucher</div>
                    <div id="voucher-name" class="muted"> Ch∆∞a s·ª≠ d·ª•ng voucher </div>
                </div>
                <div style="height:1px;background:rgba(0,0,0,0.06);margin:10px 0"></div>
                <div class="summary-row">
                    <div style="font-weight:700">T·ªïng ti·ªÅn</div>
                    <div class="total" id="total-price">0 ƒë</div>
                </div>
                <div style="font-size:12px;color:#6b6b6b;margin-top:10px">
                    B·∫±ng vi·ªác ti·∫øn h√†nh ƒë·∫∑t mua, b·∫°n ƒë√£ ƒë·ªìng √Ω v·ªõi
                    <a href="#">ƒêi·ªÅu Ki·ªán Giao D·ªãch Chung</a>
                </div>
                <div style="margin-top:12px;display:flex;gap:8px">
                    <button class="btn" style="flex:1" id="payBtn2" onclick="handlePayment()">Thanh to√°n</button>
                </div>
            </div>
        </div>
    </aside>

</main>

<div id="voucherModal">
    <div class="modal-box">
        <h3>Ch·ªçn voucher</h3>
        <ul id="voucherList"></ul>
        <div style="text-align:right">
            <button class="btn-cancel" onclick="closeVoucherModal()">Hu·ª∑</button>
        </div>
    </div>
</div>
{%endblock%}


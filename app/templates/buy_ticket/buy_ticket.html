{% extends 'layout/base.html' %}
{% block title %}Mua v√©{% endblock %}

{% block content %}
<div class="ticket-main">
    <!-- Danh s√°ch v√© b√™n tr√°i -->
    <div class="ticket-selection">
        {% for ticket in ticket_types %}
        <div class="ticket-card">
            <div class="ticket-left">
                <div class="ticket-name">{{ ticket.name }}</div>
                <ul class="ticket-benefits">
                    {% for b in ticket.benefits_list %}
                    <li>{{ b }}</li>
                    {% endfor %}
                </ul>
                <div class="ticket-price">
                    Gi√° v√©: {{ "{:,.0f}".format(ticket.price) }}ƒë
                </div>
                <div class="ticket-stock" id="stock-{{ ticket.id }}">
                    S·ªë v√© c√≤n l·∫°i: {{ ticket.quantity }}
                </div>

                <div class="quantity-selector">
                    <button onclick="decreaseTicket('{{ ticket.id }}')" class="decrease">-</button>
                    <input type="number" min="0" max="{{ ticket.quantity }}" value="0"
                           name="quantity_{{ ticket.id }}"
                           class="quantity-input"
                           id="quantity-{{ ticket.id }}"
                           data-ticket-id="{{ ticket.id }}"
                           data-price="{{ ticket.price }}"
                           data-name="{{ ticket.name }}"
                           onchange="manualTicketChange('{{ ticket.id }}')">
                    <button onclick="increaseTicket('{{ ticket.id }}')" class="increase">+</button>
                </div>

                {% if ticket.requires_seat %}
                <div class="seat-selection">
                    <button class="select-seat-btn"
                            onclick="openSeatSelection('{{ ticket.id }}', '{{ event.id }}')">
                        Ch·ªçn gh·∫ø
                    </button>
                </div>
                {%endif%}
            </div>
            <div class="ticket-right">
                <img src="{{ event.image_url }}" class="ticket-image">
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- T·ªïng v√© b√™n ph·∫£i -->
    <div class="ticket-summary">
        <h3>T·ªïng v√©:</h3>
        <h4>S·ª± ki·ªán {{event.name}}</h4>
        <ul id="summary-list"></ul>
        <p class="total" id="summary-total"><strong>üéü x0</strong></p>
       <button type="button" class="continue-btn" id="continue-btn"
        data-event-id="{{ event.id }}"
        onclick="goToCheckout()">Ti·∫øp t·ª•c >></button>
    </div>
</div>

<!-- Modal ch·ªçn gh·∫ø -->
<div id="seat-modal" class="seat-modal">
    <div class="seat-modal-content">
        <span class="close-btn" onclick="closeSeatSelection()">&times;</span>
        <h3>Ch·ªçn gh·∫ø</h3>
        <div id="seat-grid" class="seat-grid"></div>
        <div class="seat-actions">
            <button type="button" onclick="confirmSeatSelection()" class="confirm-seat-btn">X√°c nh·∫≠n</button>
        </div>
    </div>
</div>

{% endblock %}